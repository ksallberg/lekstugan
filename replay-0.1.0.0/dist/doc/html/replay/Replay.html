<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Replay</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Replay.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">replay-0.1.0.0: Implementation of a Replay monad</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Replay</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains a replay monad. A replay monad can
   decide to stop in the middle of a running computation,
   and then later pick up where it left of.
</p><p>We have a shallow implementation based around the semantics of
   the Replay type.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span>  <a href="#t:Replay">Replay</a> q r a = <a href="#v:Replay">Replay</a> {<ul class="subs"><li><a href="#v:runReplay">runReplay</a> :: <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Data-Either.html#t:Either">Either</a> (q, <a href="Replay.html#t:Trace">Trace</a> r) (a, <a href="Replay.html#t:Trace">Trace</a> r))</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Item">Item</a> r<ul class="subs"><li>= <a href="#v:Answer">Answer</a> r  </li><li>| <a href="#v:Result">Result</a> r  </li></ul></li><li class="src short"><a href="#v:liftIO">liftIO</a> :: (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> a, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> a, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> r, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> r) =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="Replay.html#t:Replay">Replay</a> q r a</li><li class="src short"><a href="#v:ask">ask</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> r =&gt; q -&gt; <a href="Replay.html#t:Replay">Replay</a> q r r</li><li class="src short"><a href="#v:emptyTrace">emptyTrace</a> ::  <a href="Replay.html#t:Trace">Trace</a> r</li><li class="src short"><a href="#v:addAnswer">addAnswer</a> ::  <a href="Replay.html#t:Trace">Trace</a> r -&gt; r -&gt; <a href="Replay.html#t:Trace">Trace</a> r</li><li class="src short"><span class="keyword">type</span> <a href="#t:Trace">Trace</a> r = [<a href="Replay.html#t:Item">Item</a> r]</li><li class="src short"><a href="#v:run">run</a> :: (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> q, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> r, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Replay.html#t:Replay">Replay</a> q r a -&gt; <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Data-Either.html#t:Either">Either</a> (q, <a href="Replay.html#t:Trace">Trace</a> r) a)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>Types
</p></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:Replay" class="def">Replay</a> q r a </p><div class="doc"><p>Type representing Replay
</p><p>Trace r -&gt; Trace r -&gt; IO
</p><p>Here, the first trace is used to do retracing. We pick
   Items from it until it's empty. When it's empty, retracing mode
   is complete. 
</p><p>The second trace is supposed to contain all traces from the
   start, and is then expanded with later computations
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Replay" class="def">Replay</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:runReplay" class="def">runReplay</a> :: <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Data-Either.html#t:Either">Either</a> (q, <a href="Replay.html#t:Trace">Trace</a> r) (a, <a href="Replay.html#t:Trace">Trace</a> r))</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Replay" class="caption collapser" onclick="toggleSection('i:Replay')">Instances</p><div id="section.i:Replay" class="show"><table><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Control-Monad.html#t:Monad">Monad</a> (<a href="Replay.html#t:Replay">Replay</a> q r)</td><td class="doc"><p>Monad implementation 
</p><p>In the case of return, a monad computation is 
   finished (completed) and we return the final replay
   wrapped in the IO monad.
</p><p>In the case of the bind definition, we transition
   from the old Replay value to a new one, carrying data
   from the old state into the new state.
</p><p>We grab the new state out of it's IO monad wrapper.
</p><p>If the state is of Right, then it's time to
      calculate the next step using the (a-&gt; Replay b) function
</p><p>(Base case)
          Here it's important to determine if the trace has a tail
          or not. If it doesn't have a tail, we will run (a-&gt;Replay b)
          with an empty list. This goes ahead and calculates the next step.
</p><p>If we have a tail, we are still in retracing mode and we have
          to keep going to get to the base case above.
</p><p>If the state is Left, then it's time to break the 
      chain and return the question produced by running <a href="a r1 r2.html">a r1 r2</a>
</p><p>r1 blir inte kortare
</p></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Item" class="def">Item</a> r </p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Answer" class="def">Answer</a> r</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Result" class="def">Result</a> r</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Item" class="caption collapser" onclick="toggleSection('i:Item')">Instances</p><div id="section.i:Item" class="show"><table><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> r =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> (<a href="Replay.html#t:Item">Item</a> r)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> r =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> (<a href="Replay.html#t:Item">Item</a> r)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="doc"><p>Operations
</p></div><div class="top"><p class="src"><a name="v:liftIO" class="def">liftIO</a> :: (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> a, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> a, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> r, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> r) =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="Replay.html#t:Replay">Replay</a> q r a</p><div class="doc"><p>Lifting function to perform IO actions and store the result
   of them in our trace. 
</p><p>the first thing we do is checking the trace to see if an 
   action has already been performed
</p><p>If it has, then we just return it (running it through a 
      helper function, r2a, to convert it to the appropriate type
</p><p>If it hasn't, we pick (lift?) the IO action out from the 
      IO monad, perform it and send the result to the trace
</p></div></div><div class="top"><p class="src"><a name="v:ask" class="def">ask</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Read.html#t:Read">Read</a> r =&gt; q -&gt; <a href="Replay.html#t:Replay">Replay</a> q r r</p><div class="doc"><p>The ask fuction uses roughly the same process as liftIO.
</p><p>If a question has already been answered in the trace, then
   we just return a Right, causing the program to go forward.
</p><p>If the question hasn't been answered, we return a Left, 
   causing the program to interrupt with a question
</p></div></div><div class="top"><p class="src"><a name="v:emptyTrace" class="def">emptyTrace</a> ::  <a href="Replay.html#t:Trace">Trace</a> r</p></div><div class="top"><p class="src"><a name="v:addAnswer" class="def">addAnswer</a> ::  <a href="Replay.html#t:Trace">Trace</a> r -&gt; r -&gt; <a href="Replay.html#t:Trace">Trace</a> r</p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Trace" class="def">Trace</a> r = [<a href="Replay.html#t:Item">Item</a> r]</p><div class="doc"><p>Type representing a trace of
   computations previously occured
</p><p>Item defined what can happen in a computation
</p></div></div><div class="doc"><p>Run function
</p></div><div class="top"><p class="src"><a name="v:run" class="def">run</a> :: (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> q, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> r, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Text-Show.html#t:Show">Show</a> a) =&gt; <a href="Replay.html#t:Replay">Replay</a> q r a -&gt; <a href="Replay.html#t:Trace">Trace</a> r -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.1-x86_64/usr/share/doc/ghc/html/libraries/base-4.5.0.0/Data-Either.html#t:Either">Either</a> (q, <a href="Replay.html#t:Trace">Trace</a> r) a)</p><div class="doc"><p>Because we are using a shallow implementation, 
   not muh work is done here. We feed the given replay 
   with a trace and return the result of that run
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>